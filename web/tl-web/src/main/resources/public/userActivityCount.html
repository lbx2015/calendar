<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>数据分析统计</title>
<link type="include" href="/common/depcss.html" />
</head>
<body class="iframeBody">
<div class="scrollbar"> 
	<div class="content">
		<div class="clear"></div>
		<div class="viewBox">
			<div id="tu1" class="FL panel"></div>
			<div id="tu2" class="FR panel"></div>
			<div id="tu3" class="FL panel"></div>
		</div>
	</div>
</div>
</body>
<link type="include" href="/common/depjs.html" />
<script type="text/javascript" src="{=ctx}/echarts/echarts.min.js"></script>
<script type="text/javascript" src="{=ctx}/echarts/world.js"></script>
<script>
    $(function () {
    	tu1Bind();
    	tu2Bind();
    	tu3Bind();
    }); 
	//获取时间
	function getSysDate() {
        var myDate = new Date(new Date().getTime()-24*60*60*1000);
        return Utils.getDate(myDate);
	}
</script>
<script type="text/javascript">
    var start;
    var end;
	function search() {
        tu1Bind();
        tu2Bind();
        tu3Bind();
	}
	//用户活跃数统计
	function tu1Bind() {
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('tu1'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: '用户活跃数统计',
             },
            tooltip: {},
            xAxis: {
                data: ["1","2","3","4","5","6","7","8","9","10","11","12"]
            },
            yAxis: {},
            series: [{
                name: '账户数量',
                type: 'bar',
                data: [5, 7, 12, 10, 10, 20, 10, 20, 13, 27, 7, 22]
            }]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
	}
	function tu2Bind() {
		var url = Const.apiUrl + "/dataCount/reportFollowCount";
		View.get(url,null, function(resp) {
			reportFollowCount(resp);
        }, function() {
            TmplUtils.showMsgFail('信息获取失败');
        });
	}
	//报表关注数统计：饼状图
	function reportFollowCount(resp) {
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('tu2'));
        // 指定图表的配置项和数据
        var option = {
      		title: {
               text: '报表关注数统计',
            },
            tooltip: {
                trigger: 'item',
                formatter: "{b} : {c}个 ({d}%)"
            },
            /* legend: {
                orient: 'vertical',
                x: 'left',
                y: 'top',
                left: 'left',
                data: ['情况1', '情况2', '情况3']
            }, */
            calculable: false,
            series: [
            	{
                //name: '账户总数',
                type: 'pie',
                label:{
  	               	normal:{
  	               		show:false,
  	               		position : 'outside'
  	               	},
  	               	emphasis:{
  	               		show :false
  	               	}
                }, 
                data: encapsulatedData(resp)
            	}
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        	myChart.on("click", eConsole);
	}
    function eConsole(param) {
		var url = "reportFollowNumCount.html?key=" + param.name;
		var title = param.name+"关注数统计";
		View.openDialog(url, title);
  	}
	  function encapsulatedData(resp){
    	var arr = [];
    	for(var i=0; i<resp.length;i++){
    		arr.push({
    			 name : resp[i].key,
    			 value : resp[i].value                       
    			 }); 
    	}
    	return arr;
    }
	//图三用户注册数统计
	function tu3Bind() {
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('tu3'));

        // 用户注册数统计
        var option = {
     		title: {
                 text: '用户注册数统计',
            },
            tooltip: {},
            legend: {
                data:['账户总数','存量账户','新开账户']
            },
            /* legend: {
                data:['用户数量']
            }, */
            xAxis: {
            	 type: 'category',
                 boundaryGap: false,
                data: ["1月份","2月份","3月份","4月份","5月份","6月份","7月份","8月份","9月份","10月份","11月份","12月份"]
            },
            yAxis: {},
            series: [
            {
                name: '账户总数',
                type: 'line',
                data: [40, 43, 44, 47, 55, 64, 72, 70, 75, 80, 84, 87]
            },
            {
                name: '存量账户',
                type: 'line',
                data: [9, 11, 12, 10, 20, 37, 27, 29, 24, 35, 30, 34]
            },
            {
                name: '新开账户',
                type: 'line',
                data: [4, 8, 11, 15, 10, 20, 16, 21, 15, 28, 6, 26]
            }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
	}
	
</script>
</html>