<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>回答</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link type="include" href="/common/depcss.html" />
    
</head>
<style>
html, body {
    height: 100%;
    margin: 0px;
    padding: 0px;
    overflow: hidden;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
}
.layui-layedit{
	position: relative;
}
.layui-layedit-tool{

background:#fff;
    width: 100%;
}
.layui-layedit-iframe{
	overflow: auto;
    position: absolute;
    top: 43px;
    left: 0;
    width: 100%;
    bottom: 0;
    -webkit-overflow-scrolling: touch;
}
.layui-layedit-iframe iframe{
	
}
</style>
<body class="iframeBody">
<div id = "content"></div>
</body>
<script type="text/javascript" src="{=ctx}/layui/layui.all.js"></script>
<script type="text/javascript" src="{=ctx}/js/core/base.js"></script>
<script type="text/javascript" src="{=ctx}/js/core/view.js"></script>
<script type="text/javascript" src="{=ctx}/js/util/tmplUtils.js"></script>
<script type="text/javascript" src="{=ctx}/js/core/resize.js"></script>

<script type="text/javascript">
	var _SYS = Tool.parseJSON('{=current_system}' || "{}");
	var Const = {
		apiUrl : _SYS.apiAccessUrl
	}
</script>
<script type="text/tmpl" id="tmpl">
<form action="" method="get" class="formbox layui-form parameterSet">
<textarea id="richText" ></textarea>
</form>
</script>
<script>
var tmpl;
var layedit;
var index;
var userId = View.getQStr("userId");
var questionId = View.getQStr("questionId");
layui.use('layedit', function(){
    layui.use('layedit', function(){
	layedit= layui.layedit;
   	layedit.set({
   	      			uploadImage: {
   	     				url: Const.apiUrl +'/tQuestion/upLoad'
   	      				,type: 'post'
   	    			}	
   	  				,tool: ['strong' //加粗
					  ,'italic' //斜体
					  ,'underline' //下划线
					  ,'del' //删除线
					  ,'|' //分割线
					  ,'left' //左对齐
					  ,'center' //居中对齐
					  ,'right' //右对齐
					  ,'|' 
					  ,'link' //超链接
					  ,'unlink' //清除链接
					  ,'face' //表情
					  ,'image' //插入图片
					  //,'help' //帮助
				]
   	  				,height: 250
   	  			});
   	});
  
});


function answerPublish(){
	var url = Const.apiUrl + '/topicQuestion/answerSave';
	var param = new Object();
	param.content = layedit.getContent(index);
	param.userId = userId;
	param.questionId = questionId;
	if(param.content == undefined || param.content == ''){
		TmplUtils.showMsgFail('请输入内容');
	}
	View.get(url,param,function(resp){
		TmplUtils.showMsgSuccess('保存成功!');
		tmpl.refresh();
		return resp;
	},function(){
		TmplUtils.showMsgFail('保存失败!');
		return false;
	});
	return true;
}

$(function (){
	$(document).unbind("click");
	tmpl = new View.Tmpl({
		"container" : $("#content"),
		"tmpl" : $("#tmpl").html()
	});
	tmpl.onload(function(attrs, param){
		var _t = this;
		_t.bind(function(callback){
			callback.call(_t,{});
			index =layedit.build('richText'); //建立编辑器
		});
	});
	
    $("._box").find("input[name='file']").attr("accept", "image/*");
    $(window).resize(function() {
         $(".layui-layedit").css("height",$(window).height());
    }).resize();
})

</script>

</html>